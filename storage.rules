rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
        // Povolí zápis každému prihlásenému používateľovi (môžeme to neskôr sprísniť, ak bude treba)
        allow write: if request.auth != null;

        // Povolí čítanie, len ak sa UID prihláseného používateľa zhoduje s 'ownerId' v metadátach súboru
        // ALEBO ak ide o hlavného profesora, ktorý vidí všetko.
        allow read: if request.auth.uid == resource.metadata.ownerId || get(/databases/(default)/documents/users/$(request.auth.uid)).data.email == 'profesor@profesor.cz';
    }
  }
}
